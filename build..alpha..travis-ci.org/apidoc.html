<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/planetk/homebridge-netatmo#readme"

    >homebridge-netatmo (v0.2.0)</a>
</h1>
<h4>Netatmo plugin for homebridge: https://github.com/nfarina/homebridge</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo">module homebridge-netatmo</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.homebridge-netatmo">
            function <span class="apidocSignatureSpan"></span>homebridge-netatmo
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_motionsensor_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_motionsensor_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.netatmo_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.netatmo_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_device
            <span class="apidocSignatureSpan">(log, api, config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_battery_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_battery_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_thermostat_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.toString">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airpressure_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airquality_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_battery_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_battery_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_co2_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_co2_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_humidity_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_noiselevel_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_rain_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_rain_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_temperature_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_wind_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_wind_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.camera_accessory">module homebridge-netatmo.camera_accessory</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_accessory.camera_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.camera_device">module homebridge-netatmo.camera_device</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_device.camera_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.camera_motionsensor_homekit">module homebridge-netatmo.camera_motionsensor_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.camera_motionsensor_homekit.camera_motionsensor_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_motionsensor_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.netatmo_accessory">module homebridge-netatmo.netatmo_accessory</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.netatmo_accessory.netatmo_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.netatmo_device">module homebridge-netatmo.netatmo_device</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.netatmo_device.netatmo_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_device
            <span class="apidocSignatureSpan">(log, api, config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.thermostat_accessory">module homebridge-netatmo.thermostat_accessory</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_accessory.thermostat_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.thermostat_battery_homekit">module homebridge-netatmo.thermostat_battery_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_battery_homekit.thermostat_battery_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_battery_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.thermostat_device">module homebridge-netatmo.thermostat_device</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_device.thermostat_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.thermostat_thermostat_homekit">module homebridge-netatmo.thermostat_thermostat_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit.thermostat_thermostat_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_thermostat_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.toString">module homebridge-netatmo.toString</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.toString.toString">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_accessory">module homebridge-netatmo.weatherstation_accessory</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_accessory.weatherstation_accessory">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_accessory
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_airpressure_legacy">module homebridge-netatmo.weatherstation_airpressure_legacy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy.weatherstation_airpressure_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airpressure_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_airquality_homekit">module homebridge-netatmo.weatherstation_airquality_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit.weatherstation_airquality_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airquality_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_battery_homekit">module homebridge-netatmo.weatherstation_battery_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_battery_homekit.weatherstation_battery_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_battery_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_co2_homekit">module homebridge-netatmo.weatherstation_co2_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_co2_homekit.weatherstation_co2_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_co2_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_device">module homebridge-netatmo.weatherstation_device</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_device.weatherstation_device">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_device
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_humidity_homekit">module homebridge-netatmo.weatherstation_humidity_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit.weatherstation_humidity_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_humidity_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_noiselevel_legacy">module homebridge-netatmo.weatherstation_noiselevel_legacy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy.weatherstation_noiselevel_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_noiselevel_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_rain_legacy">module homebridge-netatmo.weatherstation_rain_legacy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_rain_legacy.weatherstation_rain_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_rain_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_temperature_homekit">module homebridge-netatmo.weatherstation_temperature_homekit</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit.weatherstation_temperature_homekit">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_temperature_homekit
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-netatmo.weatherstation_wind_legacy">module homebridge-netatmo.weatherstation_wind_legacy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-netatmo.weatherstation_wind_legacy.weatherstation_wind_legacy">
            function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_wind_legacy
            <span class="apidocSignatureSpan">(pHomebridge)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo" id="apidoc.module.homebridge-netatmo">module homebridge-netatmo</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.homebridge-netatmo" id="apidoc.element.homebridge-netatmo.homebridge-netatmo">
        function <span class="apidocSignatureSpan"></span>homebridge-netatmo
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">homebridge-netatmo = function (pHomebridge) {

  homebridge = pHomebridge;

  homebridge.registerPlatform(&#x22;homebridge-netatmo&#x22;, &#x22;netatmo&#x22;, NetatmoPlatform);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_accessory" id="apidoc.element.homebridge-netatmo.camera_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class CameraAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData.id,
        // TODO: Check Modules in home!
        &#x22;netatmoType&#x22;: deviceData.type || &#x27;camera&#x27;,
        &#x22;firmware&#x22;: deviceData.firmware || 0.0,
        &#x22;name&#x22;: deviceData.name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.motionDetected = false;
      this.lastEventTimeStamp = 0;
      this.refreshData(function(err, data) {});

    }

    refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var homeData = this.mapAccessoryDataToCameraData(accessoryData);
      this.applyHomeData(homeData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    mapAccessoryDataToCameraData(accessoryData) {
      // this.log(JSON.stringify(accessoryData));
      var result = {};

      var events = accessoryData.events;

      var newLastEventTimeStamp = this.lastEventTimeStamp;

      result.motionDetected = false;

      if (events) {
         events.forEach(function(event) {
          if (event.time &#x3e; newLastEventTimeStamp) {
            newLastEventTimeStamp = event.time;
          }
          if (event.time &#x3e; this.lastEventTimeStamp) {
            result.motionDetected = result.motionDetected || this.eventIsMotion(event)
          }
        }.bind(this));
        this.lastEventTimeStamp = newLastEventTimeStamp;
      }

      return result;
    }

    eventIsMotion(event) {
      if (event.type == &#x27;movement&#x27;) {
        return true;
      }
      if (event.type == &#x27;person&#x27;) {
        return true;
      }
      if (event.type == &#x27;outdoor&#x27;) {
        return true;
      }
      return false;
    }

    applyHomeData(homeData) {
      var dataChanged = false

      if(this.motionDetected != homeData.motionDetected) {
        this.motionDetected = homeData.motionDetected;
        dataChanged = true;
      }

      if (dataChanged) {
        this.getServices().forEach(
          function( svc ) {
            svc.updateCharacteristics &#x26;&#x26; svc.updateCharacteristics();
          }
        );
      }

    }

  }

  return CameraAccessory;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_device" id="apidoc.element.homebridge-netatmo.camera_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    CameraAccessory = require(&#x22;../accessory/camera-accessory&#x22;)(homebridge);
  }

  class CameraDeviceType extends NetatmoDevice {
    constructor(log, api, config) {
      super(log, api, config);
      this.deviceType = &#x22;camera&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getHomeData(function (err, homeData) {
        if(!err) {
          var deviceMap = {};
          homeData.homes.forEach(function( home ) {
            deviceMap[home.id] = home;
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new CameraAccessory(deviceData, this);
    }

  }

  return CameraDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_motionsensor_homekit" id="apidoc.element.homebridge-netatmo.camera_motionsensor_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_motionsensor_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_motionsensor_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class MotionSensorService extends homebridge.hap.Service.MotionSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Motion Sensor&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.MotionDetected)
        .on(&#x27;get&#x27;, this.getMotionDetected.bind(this))
        .eventEnabled = true;

<span class="apidocCodeCommentSpan">  /*
  // Optional Characteristics
  this.addOptionalCharacteristic(Characteristic.StatusActive);
  this.addOptionalCharacteristic(Characteristic.StatusFault);
  this.addOptionalCharacteristic(Characteristic.StatusTampered);
  this.addOptionalCharacteristic(Characteristic.StatusLowBattery);
  */
</span>
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.MotionDetected)
            .updateValue(this.accessory.motionDetected);
    }

    getMotionDetected(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.motionDetected);
      }.bind(this));
    }

  }

  return MotionSensorService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.netatmo_accessory" id="apidoc.element.homebridge-netatmo.netatmo_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">netatmo_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
    Accessory = homebridge.hap.Accessory;
    Service = homebridge.hap.Service;
  }

  class NetatmoAccessory extends Accessory {
    constructor(homebridge, accessoryConfig, netatmoDevice) {

      var name = accessoryConfig.name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + accessoryConfig.id;
      var uid = homebridge.hap.uuid.generate(&#x27;netatmo.&#x27; + accessoryConfig.netatmoType + &#x27;.&#x27; + accessoryConfig.id);
      super(name, uid);

      this.log = netatmoDevice.log;
      this.config = netatmoDevice.config;
      this.device = netatmoDevice;
      this.id = accessoryConfig.id;
      this.name = name;
      this.deviceType = netatmoDevice.deviceType;
      this.netatmoType = accessoryConfig.netatmoType;
      this.firmware = accessoryConfig.firmware;
      this.dataTypes = accessoryConfig.dataTypes;

      this._configureAccessoryInformationService();
      this._buildServices(accessoryConfig.defaultServices);
    }

    getServices() {
      return this.services;
    }

    isSupportedService(serviceType) {
      return ( this.configuredServices.indexOf(serviceType) &#x3e; -1 );
    }

    _configureAccessoryInformationService() {

      var accessoryInformationService = this.getService(Service.AccessoryInformation);

      accessoryInformationService.getCharacteristic(Characteristic.FirmwareRevision)
        || accessoryInformationService.addCharacteristic(Characteristic.FirmwareRevision);

      accessoryInformationService
        .setCharacteristic(Characteristic.Model, &#x22;Netatmo &#x22; + this.deviceType + &#x22; (&#x22; + this.netatmoType + &#x22;)&#x22;)
        .setCharacteristic(Characteristic.SerialNumber, this.id)
        .setCharacteristic(Characteristic.Manufacturer, &#x22;Netatmo&#x22;)
        .setCharacteristic(Characteristic.FirmwareRevision, this.firmware);
    }

    loadConfiguredServices(defaultServices) {
      if (this.config[this.netatmoType]) {
        this.configuredServices = this.config[this.netatmoType].services || this.config.services || defaultServices;
      } else {
        this.configuredServices = this.config.services || defaultServices;
      }
    }

    notifyUpdate(deviceData) {
      console.log(&#x22;Method notifyUpdate should have been overriden &#x22; + this.name);
    }

    _buildServices(defaultServices) {
      this.loadConfiguredServices(defaultServices)
      var serviceDir = path.dirname(__dirname) + &#x27;/service&#x27;;
      var globprefix = this.deviceType;

      glob.sync( globprefix + &#x27;-*.js&#x27;, { &#x27;cwd&#x27;: serviceDir } ).forEach(
        function( file ) {
          try {
            var NetatmoService = require( serviceDir + &#x27;/&#x27; + file )(homebridge);
            var svcName = file.slice(globprefix.length + 1, -3);
            if(this.isSupportedService(svcName)) {
              this.log.debug(&#x22;Adding Service in &#x22; + this.name + &#x22;: &#x22; + svcName);

              var service = new NetatmoService(this);
              this.addService(service);

            } else {
              this.log.debug(&#x22;Service not supported in &#x22; + this.name + &#x22;: &#x22;  + svcName);
            }
          } catch (err) {
            this.log.warn(&#x22;Could not process service file &#x22; + file);
            this.log.warn(err);
            this.log.warn(err.stack);
          }
        }.bind(this)
      );
    }

  }

  return NetatmoAccessory;


  /*
  var serviceDir = path.dirname(__dirname) + &#x27;/services&#x27;;
  var globprefix = netAtmoDevice.deviceType;
  glob.sync( globprefix + &#x27;-*.js&#x27;, { &#x27;cwd&#x27;: serviceDir } ).forEach( function( file ) {
    try {
      var service = require( serviceDir + &#x27;/&#x27; + file )(this, stationData);
      if(this.isConfiguredService(file.slice(globprefix.length + 1, -3))) {
        var serviceProvider = new service.ServiceProvider();
        var services = serviceProvider.buildServices(this, stationData);
        if (services) {
          services.forEach(function(svc) {
            this.addService(svc);
          }.bind(this));
        }
      }
    } catch (err) {
      this.log(&#x22;Could not process fil ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.netatmo_device" id="apidoc.element.homebridge-netatmo.netatmo_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_device
        <span class="apidocSignatureSpan">(log, api, config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">class NetatmoDevice {
  constructor(log, api, config) {
    this.api = api;
    this.log = log;
    var ttl = typeof config[&#x22;ttl&#x22;] !== &#x27;undefined&#x27; ? config[&#x22;ttl&#x22;] : DEFAULT_CACHE_TTL;
    this.cache = new NodeCache({stdTTL: ttl});
    this.config = config;

    this.deviceData = null;
    this.accessories = [];
    this.refreshRequired = false;
    this.refreshRunning = false;
    this.refreshCheckRunning = false;

    this.runCheckInterval = setInterval(function() {
      if(!this.refreshCheckRunning ) {
        this.refreshCheckRunning = true;
        if(this.refreshRequired) {
          this.log.debug(&#x22;Executing Timed Refresh&#x22;);

          this.refreshRequired=false;
          this.refreshDeviceData(function(err, data) {
            if (this.accessories) {
              this.accessories.forEach(function( accessory ) {
                accessory.notifyUpdate(data);
              }.bind(this));
            }
            this.refreshCheckRunning = false;
          }.bind(this));
        } else {
          this.refreshCheckRunning = false;
        }
      }
    }.bind(this), REFRESH_RUN_RATE);

    this.refreshDataInterval = setInterval(function() {
      this.refreshRequired = true;
    }.bind(this), REFRESH_CHECK_RATE);

  }

  buildAccessoriesForDevices(callback) {
    var accessories = [];
    this.refreshDeviceData(function(err, data) {
      if (!err) {
        this.buildAccessories(callback);
      } else {
        callback(err, accessories);
      }
    }.bind(this));
  }

  refreshDeviceData(callback) {
    this.log.debug(&#x22;Refreshing data for netatmo &#x22; + this.deviceType);
    this.cache.get(this.deviceType, function (err, data) {
      if (!err) {
        if (data == undefined) {
          this.log.debug(&#x22;Loading new data from netatmo for &#x22; + this.deviceType);
          this.loadDeviceData(function(err, data) {
            callback(err,data);
          }.bind(this));
        } else {
          this.deviceData = data;
          callback(null, data);
        }
      } else {
        callback(err, this.deviceData);
      }
    }.bind(this));
  }

  forceRefresh() {
    this.cache.del(this.deviceType, function(err,count) {
      this.refreshRequired = true;
    }.bind(this));
  }

  loadDeviceData(callback) {
    this.deviceData = null;
    callback(&#x22;The abstract method loadDeviceData should be overridden&#x22;, null)
  }

  buildAccessories(callback) {
    Object.keys(this.deviceData).forEach(function(key) {

      // key is id! Should go into blacklist / whitelist !

      var keep = true;

      if (this.config.whitelist &#x26;&#x26; this.config.whitelist.length &#x3e; 0) {
        keep = (this.config.whitelist.indexOf(key) &#x3e; -1);
      }
      if (this.config.blacklist &#x26;&#x26; this.config.blacklist.length &#x3e; 0) {
        keep = keep &#x26;&#x26; (this.config.blacklist.indexOf(key) &#x3c; 0);
      }

      if ( keep ) {
        var accessory = this.buildAccessory(this.deviceData[key]);
        this.log.debug(&#x22;Did build accessory &#x22; + accessory.name );
        this.accessories.push(accessory);
      }


    }.bind(this));
    callback(null, this.accessories);
  }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_accessory" id="apidoc.element.homebridge-netatmo.thermostat_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class ThermostatAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData._id,
        &#x22;netatmoType&#x22;: deviceData.type,
        &#x22;firmware&#x22;: deviceData.firmware,
        &#x22;name&#x22;: deviceData.station_name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES
//        &#x22;dataTypes&#x22;
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.module_id = deviceData.modules[0]._id;
      this.currentTemperature = 11.1;
      this.targetTemperature = 20.0;
      this.batteryPercent = 100;
      this.lowBattery = false;

      this.currentHeatingCoolingState = Characteristic.CurrentHeatingCoolingState.OFF;
      this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.OFF;

      this.refreshData(function(err, data) {});

    }

    refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var thermostatData = this.mapAccessoryDataToThermostatData(accessoryData);
      this.applyThermostatData(thermostatData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    mapAccessoryDataToThermostatData(accessoryData) {
      // this.log(JSON.stringify(accessoryData));
      var result = {};
      var module = accessoryData.modules[0];

      if (module) {
        result.currentTemperature = module.measured.temperature;

        result.targetTemperature = 0;
        if (module.measured.setpoint_temp) {
          result.targetTemperature = module.measured.setpoint_temp;
        }

        var setpoint = module.setpoint;
        if (setpoint) {
          if (setpoint.setpoint_temp != undefined) {
            result.targetTemperature = setpoint.setpoint_temp;
            result.mode = setpoint.setpoint_mode;
          }
        }

        if (result.targetTemperature &#x3c; 10) result.targetTemperature = 10;

        result.heating = (module.therm_relay_cmd != 0);
        result.batteryPercent = module.battery_percent;

        result.lowBattery = false;
        if (module.battery_vp) {
          if (!result.batteryPercent) {
            result.batteryPercent = Math.min(Math.round(Math.max(module.battery_vp - MIN_BATTERY_LEVEL, 0) / (FULL_BATTERY_LEVEL
 - MIN_BATTERY_LEVEL) * 100), 100);
          }
          if (module.battery_vp &#x3c; LOW_BATTERY_LEVEL) {
            result.lowBattery = true;
          }
        }
        if (!result.batteryPercent) {
          result.batteryPercent = 100;
        }
      } else {
        this.device.forceRefresh();
      }
      return result;
    }

    applyThermostatData(thermostatData) {
      var dataChanged = false

      if(thermostatData.currentTemperature &#x26;&#x26; this.currentTemperature != thermostatData.currentTemperature) {
        this.currentTemperature = thermostatData.currentTemperature;
        dataChanged = true;
      }

      if(thermostatData.targetTemperature &#x26;&#x26; this.targetTemperature != thermostatData.targetTemperature) {
        this.targetTemperature = thermostatData.targetTemperature;
        dataChanged = true;
      }

      if(thermostatData.mode &#x26;&#x26; this.mode != thermostatData.mode) {
        this.mode = thermostatData.mode;
        switch(this.mode) {
          case &#x27;hg&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.COOL;
            break;
          case &#x27;max&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.HEAT;
            break;
          case &#x27;off&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCooli ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_battery_homekit" id="apidoc.element.homebridge-netatmo.thermostat_battery_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_battery_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_battery_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class BatteryService extends homebridge.hap.Service.BatteryService {
    constructor(accessory) {
      super(accessory.name + &#x22; Thermostat&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.BatteryLevel)
        .on(&#x27;get&#x27;, this.getBatteryLevel.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.StatusLowBattery)
        .on(&#x27;get&#x27;, this.getStatusLowBattery.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.ChargingState)
        .on(&#x27;get&#x27;, this.getChargingState.bind(this));
    }

    getBatteryLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.batteryPercent);
      }.bind(this));
    }

    getStatusLowBattery(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
      }.bind(this));
    }

    getChargingState(callback) {
      callback(null, Characteristic.ChargingState.NOT_CHARGING);
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.BatteryLevel)
            .updateValue(this.accessory.batteryPercent);
      this.getCharacteristic(Characteristic.StatusLowBattery)
            .updateValue(this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
    }
  }

  return BatteryService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_device" id="apidoc.element.homebridge-netatmo.thermostat_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    ThermostatAccessory = require(&#x22;../accessory/thermostat-accessory&#x22;)(homebridge);
  }

  class ThermostatDeviceType extends NetatmoDevice {
    constructor(log, api, config) {
      super(log, api, config);
      this.deviceType = &#x22;thermostat&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getThermostatsData(function (err, devices) {
        if(!err) {
          var deviceMap = {};
          devices.forEach(function( device ) {
            deviceMap[device[&#x22;_id&#x22;]] = device;
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new ThermostatAccessory(deviceData, this);
    }

  }

  return ThermostatDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit" id="apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_thermostat_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_thermostat_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class ThermostatService extends homebridge.hap.Service.Thermostat {
    constructor(accessory) {
      super(accessory.name + &#x22; Thermostat&#x22;);
      this.accessory = accessory;

      this.temperatureDisplayUnits = Characteristic.TemperatureDisplayUnits.CELSIUS;

      this.getCharacteristic(Characteristic.CurrentHeatingCoolingState)
        .on(&#x27;get&#x27;, this.getCurrentHeatingCoolingState.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TargetHeatingCoolingState)
        .on(&#x27;get&#x27;, this.getTargetHeatingCoolingState.bind(this))
        .on(&#x27;set&#x27;, this.setTargetHeatingCoolingState.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.CurrentTemperature)
        .on(&#x27;get&#x27;, this.getCurrentTemperature.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TargetTemperature)
        .on(&#x27;get&#x27;, this.getTargetTemperature.bind(this))
        .on(&#x27;set&#x27;, this.setTargetTemperature.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TemperatureDisplayUnits)
        .on(&#x27;get&#x27;, this.getTemperatureDisplayUnits.bind(this))
        .on(&#x27;set&#x27;, this.setTemperatureDisplayUnits.bind(this));

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentHeatingCoolingState)
            .updateValue(this.accessory.currentHeatingCoolingState);
      this.getCharacteristic(Characteristic.TargetHeatingCoolingState)
            .updateValue(this.accessory.targetHeatingCoolingState);
      this.getCharacteristic(Characteristic.CurrentTemperature)
            .updateValue(this.accessory.currentTemperature);
      // TODO: Unter 10 -&#x3e; Was tun?
      this.getCharacteristic(Characteristic.TargetTemperature)
            .updateValue(this.accessory.targetTemperature);
    }

    getCurrentHeatingCoolingState(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentHeatingCoolingState);
      }.bind(this));
    }

    getCurrentTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentTemperature);
      }.bind(this));
    }

    getTargetHeatingCoolingState(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.targetHeatingCoolingState);
      }.bind(this));
    }

    setTargetHeatingCoolingState(value, callback) {

        if (this.accessory.targetHeatingCoolingState === value) {
            callback(null, value);
            return;
        }

        switch (value) {
          case Characteristic.TargetHeatingCoolingState.OFF:
            this.accessory.setThermpoint(&#x27;off&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          case Characteristic.TargetHeatingCoolingState.COOL:
            this.accessory.setThermpoint(&#x27;hg&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          case Characteristic.TargetHeatingCoolingState.HEAT:
            this.accessory.setThermpoint(&#x27;max&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          default: // Characteristic.TargetHeatingCoolingState.AUTO:
            this.accessory.setThermpoint(&#x27;program&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
        }
    }

    getTargetTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.targetTemperature);
      }.bind(this));
    }

    setTargetTemperature(value, callback) {
      if (value &#x3e; 30) {
        value = 30;
      }

      if (value == this.accessory.targetTemperature) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.toString" id="apidoc.element.homebridge-netatmo.toString">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    return text;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_accessory" id="apidoc.element.homebridge-netatmo.weatherstation_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class WeatherStationAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var dataTypes = deviceData.data_type;
      if (deviceData.battery_vp) {
        dataTypes.push(&#x22;Battery&#x22;);
      }

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData._id,
        &#x22;netatmoType&#x22;: deviceData.type,
        &#x22;firmware&#x22;: deviceData.firmware,
        &#x22;name&#x22;: deviceData._name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES,
        &#x22;dataTypes&#x22;: dataTypes
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.currentTemperature = 11.1;
      this.co2 = 500;
      this.batteryPercent = 100;
      this.lowBattery = false;
      this.airPressure = 1000;
      this.humidity = 50;
			this.noiseLevel = 0;
      this.rainLevel = 0.0;
      this.rainLevelSum1 = 0.0;
      this.rainLevelSum24 = 0.0;
      this.windStrength = 0;
      this.windAngle = 0;
      this.gustStrength = 0;
      this.gustAngle = 0;

      this.refreshData(function(err, data) {});
  	}

  	refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var weatherData = this.mapAccessoryDataToWeatherData(accessoryData);
      this.applyWeatherData(weatherData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    getLowBatteryLevel() {
      var levels = {
        NAMain: 4560,
        NAModule1: 4000,
        NAModule2: 4360,
        NAModule3: 4000,
        NAModule4: 4560
      }

      if (levels[this.netatmoType]) {
        return levels[this.netatmoType];
      }
      return 4560;
    }

    getFullBatteryLevel() {
      var levels = {
        NAMain: 5640,
        NAModule1: 5500,
        NAModule2: 5590,
        NAModule3: 5500,
        NAModule4: 5640
      }

      if (levels[this.netatmoType]) {
        return levels[this.netatmoType];
      }
      return 5640;
    }


		mapAccessoryDataToWeatherData(accessoryData) {
		  var result = {};

		  var dashboardData = accessoryData.dashboard_data;
		  if (dashboardData) {
		  	if (dashboardData.Temperature) {
          result.currentTemperature = dashboardData.Temperature;
        }
        if (dashboardData.CO2) {
          result.co2 = dashboardData.CO2;
        }
        if (dashboardData.Pressure) {
          result.airPressure = dashboardData.Pressure;
        }
        if (dashboardData.Humidity) {
          result.humidity = dashboardData.Humidity;
        }
        if (dashboardData.Noise) {
          result.noiseLevel = dashboardData.Noise;
        }
        if (dashboardData.Rain) {
          result.rainLevel = Math.round(dashboardData.Rain * 1000) / 1000;
        }
        if (dashboardData.sum_rain_1) {
          result.rainLevelSum1 = Math.round(dashboardData.sum_rain_1 * 1000) / 1000;
        }
        if (dashboardData.sum_rain_24) {
          result.rainLevelSum24 = Math.round(dashboardData.sum_rain_24 * 1000) / 1000;
        }
        if (dashboardData.WindStrength) {
          result.windStrength = Math.round(dashboardData.WindStrength);
        }
        if (dashboardData.WindAngle) {
          result.windAngle = Math.round(dashboardData.WindAngle);
        }
        if (dashboardData.GustStrength) {
          result.gustStrength = Math.round(dashboardData.GustStrength);
        }
        if (dashboardData.GustAngle) {
          result.gustAngle = Math.round(dashboardData.GustAngle);
        }
		  }

      result.batteryPercent = accessoryData.battery_percent;
      result.lowBattery = false;

      if (accessoryData.battery_vp) {
        if (!result.batteryPercent ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airpressure_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_airpressure_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class AtmosphericPressureCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Atmospheric Pressure&#x27;, ATMOSPHERIC_PRESSURE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;hPA&#x22;,
        minValue: 500,
        maxValue: 2000,
        minStep: 0.1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class AirPressureService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Air Pressure&#x22;, ATMOSPHERIC_PRESSURE_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(AtmosphericPressureCharacteristic)
        .on(&#x27;get&#x27;, this.getAtmosphericPressure.bind(this))
        .eventEnabled = true;

      // this.addOptionalCharacteristic(Characteristic.StatusActive);
      // this.addOptionalCharacteristic(Characteristic.StatusFault);
      this.addOptionalCharacteristic(Characteristic.Name);

    }

    updateCharacteristics() {
      this.getCharacteristic(AtmosphericPressureCharacteristic)
            .updateValue(this.accessory.airPressure);
    }

    getAtmosphericPressure(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.airPressure);
      }.bind(this));
    }

  }

  return AirPressureService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airquality_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_airquality_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class AirQualityService extends homebridge.hap.Service.AirQualitySensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Air Quality&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.AirQuality)
        .on(&#x27;get&#x27;, this.getAirQuality.bind(this))
        .eventEnabled = true;

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.AirQuality)
            .updateValue(this.transformCO2ToAirQuality());
    }

    getAirQuality(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.transformCO2ToAirQuality());
      }.bind(this));
    }

    transformCO2ToAirQuality() {
      var level = this.accessory.co2;
      var quality = Characteristic.AirQuality.UNKNOWN;

      if (level &#x3e; 2000) quality = Characteristic.AirQuality.POOR;
      else if (level &#x3e; 1500) quality = Characteristic.AirQuality.INFERIOR;
      else if (level &#x3e; 1000) quality = Characteristic.AirQuality.FAIR;
      else if (level &#x3e; 500) quality = Characteristic.AirQuality.GOOD;
      else if (level &#x3e; 0) quality = Characteristic.AirQuality.EXCELLENT;

      return quality;
    }

  }

  return AirQualityService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_battery_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_battery_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_battery_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_battery_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class BatteryService extends homebridge.hap.Service.BatteryService {
    constructor(accessory) {
      super(accessory.name + &#x22; Battery Level&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.BatteryLevel)
        .on(&#x27;get&#x27;, this.getBatteryLevel.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.StatusLowBattery)
        .on(&#x27;get&#x27;, this.getStatusLowBattery.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.ChargingState)
        .on(&#x27;get&#x27;, this.getChargingState.bind(this));
    }

    getBatteryLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.batteryPercent);
      }.bind(this));
    }

    getStatusLowBattery(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
      }.bind(this));
    }

    getChargingState(callback) {
      callback(null, Characteristic.ChargingState.NOT_CHARGING);
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.BatteryLevel)
            .updateValue(this.accessory.batteryPercent);
      this.getCharacteristic(Characteristic.StatusLowBattery)
            .updateValue(this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
    }
  }

  return BatteryService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_co2_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_co2_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_co2_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_co2_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class CarbonDioxideService extends homebridge.hap.Service.CarbonDioxideSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Carbon Dioxide&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.CarbonDioxideDetected)
        .on(&#x27;get&#x27;, this.getCarbonDioxideDetected.bind(this))
        .eventEnabled = true;

      var co2LevelCharacteristic = this.getCharacteristic(Characteristic.CarbonDioxideLevel)
                                          || this.addCharacteristic(Characteristic.CarbonDioxideLevel);

      co2LevelCharacteristic.on(&#x27;get&#x27;, this.getCarbonDioxideLevel.bind(this))
                            .eventEnabled = true;
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CarbonDioxideDetected)
            .updateValue(this.transformCO2ToCarbonDioxideDetected());
      this.getCharacteristic(Characteristic.CarbonDioxideLevel)
            .updateValue(this.accessory.co2);
    }

    getCarbonDioxideDetected(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.transformCO2ToCarbonDioxideDetected());
      }.bind(this));
    }

    getCarbonDioxideLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.co2);
      }.bind(this));
    }

    transformCO2ToCarbonDioxideDetected() {
      return (this.accessory.co2 &#x3e; 1000 ? Characteristic.CarbonDioxideDetected.CO2_LEVELS_ABNORMAL : Characteristic.CarbonDioxideDetected
.CO2_LEVELS_NORMAL);
    }
  }

  return CarbonDioxideService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_device" id="apidoc.element.homebridge-netatmo.weatherstation_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    WeatherStationAccessory = require(&#x22;../accessory/weatherstation-accessory&#x22;)(homebridge);
  }

  class WeatherstationDeviceType extends NetatmoDevice {
  	constructor(log, api, config) {
      super(log, api, config);
      this.log.debug(&#x22;Creating Weatherstation Devices&#x22;);
      this.deviceType = &#x22;weatherstation&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getStationsData(function (err, devices) {
        if(!err) {
          var deviceMap = {};
          devices.forEach(function( device ) {
            deviceMap[device[&#x22;_id&#x22;]] = device;
            device._name = device.station_name + &#x22; &#x22; + device.module_name
            if (device.modules) {
              device.modules.forEach(function( module ) {
                module._name = device.station_name + &#x22; &#x22; + module.module_name
                deviceMap[module._id] = module;
              }.bind(this));
            }
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new WeatherStationAccessory(deviceData, this);
    }
  }

  return WeatherstationDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_humidity_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_humidity_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class HumidityService extends homebridge.hap.Service.HumiditySensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Humidity&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.CurrentRelativeHumidity)
        .on(&#x27;get&#x27;, this.getCurrentRelativeHumidity.bind(this))
        .eventEnabled = true;
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentRelativeHumidity)
            .updateValue(this.accessory.humidity);
    }

    getCurrentRelativeHumidity(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.humidity);
      }.bind(this));
    }
  }

  return HumidityService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_noiselevel_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_noiselevel_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class NoiseLevelCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Noise Level&#x27;, NOISE_LEVEL_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;dB&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class NoiseLevelService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Noise Level&#x22;, NOISE_LEVEL_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(NoiseLevelCharacteristic)
        .on(&#x27;get&#x27;, this.getNoiseLevel.bind(this))
        .eventEnabled = true;

      // this.addOptionalCharacteristic(Characteristic.StatusActive);
      // this.addOptionalCharacteristic(Characteristic.StatusFault);
      // this.addOptionalCharacteristic(Characteristic.StatusTampered);
      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(NoiseLevelCharacteristic)
            .updateValue(this.accessory.noiseLevel);
    }

    getNoiseLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.noiseLevel);
      }.bind(this));
    }

  }

  return NoiseLevelService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_rain_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_rain_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_rain_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_rain_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class RainLevelCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level&#x27;, RAIN_LEVEL_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelSum1Characteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level (1 hour)&#x27;, RAIN_LEVEL_SUM_1H_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelSum24Characteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level (24 hours)&#x27;, RAIN_LEVEL_SUM_24H_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Rain Level&#x22;, RAIN_LEVEL_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(RainLevelCharacteristic)
        .on(&#x27;get&#x27;, this.getRainLevel.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(RainLevelSum1Characteristic)
        .on(&#x27;get&#x27;, this.getRainLevelSum1.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(RainLevelSum24Characteristic)
        .on(&#x27;get&#x27;, this.getRainLevelSum24.bind(this))
        .eventEnabled = true;

      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(RainLevelCharacteristic)
            .updateValue(this.accessory.rainLevel);
      this.getCharacteristic(RainLevelSum1Characteristic)
            .updateValue(this.accessory.rainLevelSum1);
      this.getCharacteristic(RainLevelSum24Characteristic)
            .updateValue(this.accessory.rainLevelSum24);
    }

    getRainLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevel);
      }.bind(this));
    }

    getRainLevelSum1(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevelSum1);
      }.bind(this));
    }

    getRainLevelSum24(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevelSum24);
      }.bind(this));
    }
  }

  return RainLevelService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_temperature_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_temperature_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class TemperatureService extends homebridge.hap.Service.TemperatureSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Temperature&#x22;);
      this.accessory = accessory;

      var tmpChar = this.getCharacteristic(Characteristic.CurrentTemperature);
      tmpChar.setProps({ minValue: -100 });
      tmpChar.on(&#x27;get&#x27;, this.getCurrentTemperature.bind(this));
      tmpChar.eventEnabled = true;

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentTemperature)
            .updateValue(this.accessory.currentTemperature);
    }

    getCurrentTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentTemperature);
      }.bind(this));
    }
  }

  return TemperatureService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_wind_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_wind_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_wind_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_wind_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class WindStrengthCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Wind Strength&#x27;, WIND_STRENGTH_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
              format: Characteristic.Formats.UINT8,
        unit: &#x22;km/h&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class WindAngleCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Wind Angle&#x27;, WIND_ANGLE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;deg&#x22;,
        minValue: 0,
        maxValue: 360,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class GustStrengthCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Gust Strength&#x27;, GUST_STRENGTH_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
              format: Characteristic.Formats.UINT8,
        unit: &#x22;km/h&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class GustAngleCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Gust Angle&#x27;, GUST_ANGLE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;deg&#x22;,
        minValue: 0,
        maxValue: 360,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class WindService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Wind Sensor&#x22;, WIND_MEASURE_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(WindStrengthCharacteristic)
        .on(&#x27;get&#x27;, this.getWindStrength.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(WindAngleCharacteristic)
        .on(&#x27;get&#x27;, this.getWindAngle.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(GustStrengthCharacteristic)
        .on(&#x27;get&#x27;, this.getGustStrength.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(GustAngleCharacteristic)
        .on(&#x27;get&#x27;, this.getGustAngle.bind(this))
        .eventEnabled = true;

      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(WindStrengthCharacteristic)
            .updateValue(this.accessory.windStrength);
      this.getCharacteristic(WindAngleCharacteristic)
            .updateValue(this.accessory.windAngle);
      this.getCharacteristic(GustStrengthCharacteristic)
            .updateValue(this.accessory.gustStrength);
      this.getCharacteristic(GustAngleCharacteristic)
            .updateValue(this.accessory.gustAngle);
    }

    getWindStrength(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.windStrength);
      }.bind(this));
    }

    getWindAngle(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.windAngle);
      }.bind(this));
    }

    getGustStrength(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.gustStrength);
      }.bind(this));
    }

    getGustAngle(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.gustAngle);
      }.bind(this));
    }
  }

  return WindService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.camera_accessory" id="apidoc.module.homebridge-netatmo.camera_accessory">module homebridge-netatmo.camera_accessory</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_accessory.camera_accessory" id="apidoc.element.homebridge-netatmo.camera_accessory.camera_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class CameraAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData.id,
        // TODO: Check Modules in home!
        &#x22;netatmoType&#x22;: deviceData.type || &#x27;camera&#x27;,
        &#x22;firmware&#x22;: deviceData.firmware || 0.0,
        &#x22;name&#x22;: deviceData.name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.motionDetected = false;
      this.lastEventTimeStamp = 0;
      this.refreshData(function(err, data) {});

    }

    refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var homeData = this.mapAccessoryDataToCameraData(accessoryData);
      this.applyHomeData(homeData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    mapAccessoryDataToCameraData(accessoryData) {
      // this.log(JSON.stringify(accessoryData));
      var result = {};

      var events = accessoryData.events;

      var newLastEventTimeStamp = this.lastEventTimeStamp;

      result.motionDetected = false;

      if (events) {
         events.forEach(function(event) {
          if (event.time &#x3e; newLastEventTimeStamp) {
            newLastEventTimeStamp = event.time;
          }
          if (event.time &#x3e; this.lastEventTimeStamp) {
            result.motionDetected = result.motionDetected || this.eventIsMotion(event)
          }
        }.bind(this));
        this.lastEventTimeStamp = newLastEventTimeStamp;
      }

      return result;
    }

    eventIsMotion(event) {
      if (event.type == &#x27;movement&#x27;) {
        return true;
      }
      if (event.type == &#x27;person&#x27;) {
        return true;
      }
      if (event.type == &#x27;outdoor&#x27;) {
        return true;
      }
      return false;
    }

    applyHomeData(homeData) {
      var dataChanged = false

      if(this.motionDetected != homeData.motionDetected) {
        this.motionDetected = homeData.motionDetected;
        dataChanged = true;
      }

      if (dataChanged) {
        this.getServices().forEach(
          function( svc ) {
            svc.updateCharacteristics &#x26;&#x26; svc.updateCharacteristics();
          }
        );
      }

    }

  }

  return CameraAccessory;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.camera_device" id="apidoc.module.homebridge-netatmo.camera_device">module homebridge-netatmo.camera_device</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_device.camera_device" id="apidoc.element.homebridge-netatmo.camera_device.camera_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    CameraAccessory = require(&#x22;../accessory/camera-accessory&#x22;)(homebridge);
  }

  class CameraDeviceType extends NetatmoDevice {
    constructor(log, api, config) {
      super(log, api, config);
      this.deviceType = &#x22;camera&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getHomeData(function (err, homeData) {
        if(!err) {
          var deviceMap = {};
          homeData.homes.forEach(function( home ) {
            deviceMap[home.id] = home;
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new CameraAccessory(deviceData, this);
    }

  }

  return CameraDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.camera_motionsensor_homekit" id="apidoc.module.homebridge-netatmo.camera_motionsensor_homekit">module homebridge-netatmo.camera_motionsensor_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.camera_motionsensor_homekit.camera_motionsensor_homekit" id="apidoc.element.homebridge-netatmo.camera_motionsensor_homekit.camera_motionsensor_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>camera_motionsensor_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">camera_motionsensor_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class MotionSensorService extends homebridge.hap.Service.MotionSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Motion Sensor&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.MotionDetected)
        .on(&#x27;get&#x27;, this.getMotionDetected.bind(this))
        .eventEnabled = true;

<span class="apidocCodeCommentSpan">  /*
  // Optional Characteristics
  this.addOptionalCharacteristic(Characteristic.StatusActive);
  this.addOptionalCharacteristic(Characteristic.StatusFault);
  this.addOptionalCharacteristic(Characteristic.StatusTampered);
  this.addOptionalCharacteristic(Characteristic.StatusLowBattery);
  */
</span>
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.MotionDetected)
            .updateValue(this.accessory.motionDetected);
    }

    getMotionDetected(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.motionDetected);
      }.bind(this));
    }

  }

  return MotionSensorService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.netatmo_accessory" id="apidoc.module.homebridge-netatmo.netatmo_accessory">module homebridge-netatmo.netatmo_accessory</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.netatmo_accessory.netatmo_accessory" id="apidoc.element.homebridge-netatmo.netatmo_accessory.netatmo_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">netatmo_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
    Accessory = homebridge.hap.Accessory;
    Service = homebridge.hap.Service;
  }

  class NetatmoAccessory extends Accessory {
    constructor(homebridge, accessoryConfig, netatmoDevice) {

      var name = accessoryConfig.name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + accessoryConfig.id;
      var uid = homebridge.hap.uuid.generate(&#x27;netatmo.&#x27; + accessoryConfig.netatmoType + &#x27;.&#x27; + accessoryConfig.id);
      super(name, uid);

      this.log = netatmoDevice.log;
      this.config = netatmoDevice.config;
      this.device = netatmoDevice;
      this.id = accessoryConfig.id;
      this.name = name;
      this.deviceType = netatmoDevice.deviceType;
      this.netatmoType = accessoryConfig.netatmoType;
      this.firmware = accessoryConfig.firmware;
      this.dataTypes = accessoryConfig.dataTypes;

      this._configureAccessoryInformationService();
      this._buildServices(accessoryConfig.defaultServices);
    }

    getServices() {
      return this.services;
    }

    isSupportedService(serviceType) {
      return ( this.configuredServices.indexOf(serviceType) &#x3e; -1 );
    }

    _configureAccessoryInformationService() {

      var accessoryInformationService = this.getService(Service.AccessoryInformation);

      accessoryInformationService.getCharacteristic(Characteristic.FirmwareRevision)
        || accessoryInformationService.addCharacteristic(Characteristic.FirmwareRevision);

      accessoryInformationService
        .setCharacteristic(Characteristic.Model, &#x22;Netatmo &#x22; + this.deviceType + &#x22; (&#x22; + this.netatmoType + &#x22;)&#x22;)
        .setCharacteristic(Characteristic.SerialNumber, this.id)
        .setCharacteristic(Characteristic.Manufacturer, &#x22;Netatmo&#x22;)
        .setCharacteristic(Characteristic.FirmwareRevision, this.firmware);
    }

    loadConfiguredServices(defaultServices) {
      if (this.config[this.netatmoType]) {
        this.configuredServices = this.config[this.netatmoType].services || this.config.services || defaultServices;
      } else {
        this.configuredServices = this.config.services || defaultServices;
      }
    }

    notifyUpdate(deviceData) {
      console.log(&#x22;Method notifyUpdate should have been overriden &#x22; + this.name);
    }

    _buildServices(defaultServices) {
      this.loadConfiguredServices(defaultServices)
      var serviceDir = path.dirname(__dirname) + &#x27;/service&#x27;;
      var globprefix = this.deviceType;

      glob.sync( globprefix + &#x27;-*.js&#x27;, { &#x27;cwd&#x27;: serviceDir } ).forEach(
        function( file ) {
          try {
            var NetatmoService = require( serviceDir + &#x27;/&#x27; + file )(homebridge);
            var svcName = file.slice(globprefix.length + 1, -3);
            if(this.isSupportedService(svcName)) {
              this.log.debug(&#x22;Adding Service in &#x22; + this.name + &#x22;: &#x22; + svcName);

              var service = new NetatmoService(this);
              this.addService(service);

            } else {
              this.log.debug(&#x22;Service not supported in &#x22; + this.name + &#x22;: &#x22;  + svcName);
            }
          } catch (err) {
            this.log.warn(&#x22;Could not process service file &#x22; + file);
            this.log.warn(err);
            this.log.warn(err.stack);
          }
        }.bind(this)
      );
    }

  }

  return NetatmoAccessory;


  /*
  var serviceDir = path.dirname(__dirname) + &#x27;/services&#x27;;
  var globprefix = netAtmoDevice.deviceType;
  glob.sync( globprefix + &#x27;-*.js&#x27;, { &#x27;cwd&#x27;: serviceDir } ).forEach( function( file ) {
    try {
      var service = require( serviceDir + &#x27;/&#x27; + file )(this, stationData);
      if(this.isConfiguredService(file.slice(globprefix.length + 1, -3))) {
        var serviceProvider = new service.ServiceProvider();
        var services = serviceProvider.buildServices(this, stationData);
        if (services) {
          services.forEach(function(svc) {
            this.addService(svc);
          }.bind(this));
        }
      }
    } catch (err) {
      this.log(&#x22;Could not process fil ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.netatmo_device" id="apidoc.module.homebridge-netatmo.netatmo_device">module homebridge-netatmo.netatmo_device</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.netatmo_device.netatmo_device" id="apidoc.element.homebridge-netatmo.netatmo_device.netatmo_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>netatmo_device
        <span class="apidocSignatureSpan">(log, api, config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">class NetatmoDevice {
  constructor(log, api, config) {
    this.api = api;
    this.log = log;
    var ttl = typeof config[&#x22;ttl&#x22;] !== &#x27;undefined&#x27; ? config[&#x22;ttl&#x22;] : DEFAULT_CACHE_TTL;
    this.cache = new NodeCache({stdTTL: ttl});
    this.config = config;

    this.deviceData = null;
    this.accessories = [];
    this.refreshRequired = false;
    this.refreshRunning = false;
    this.refreshCheckRunning = false;

    this.runCheckInterval = setInterval(function() {
      if(!this.refreshCheckRunning ) {
        this.refreshCheckRunning = true;
        if(this.refreshRequired) {
          this.log.debug(&#x22;Executing Timed Refresh&#x22;);

          this.refreshRequired=false;
          this.refreshDeviceData(function(err, data) {
            if (this.accessories) {
              this.accessories.forEach(function( accessory ) {
                accessory.notifyUpdate(data);
              }.bind(this));
            }
            this.refreshCheckRunning = false;
          }.bind(this));
        } else {
          this.refreshCheckRunning = false;
        }
      }
    }.bind(this), REFRESH_RUN_RATE);

    this.refreshDataInterval = setInterval(function() {
      this.refreshRequired = true;
    }.bind(this), REFRESH_CHECK_RATE);

  }

  buildAccessoriesForDevices(callback) {
    var accessories = [];
    this.refreshDeviceData(function(err, data) {
      if (!err) {
        this.buildAccessories(callback);
      } else {
        callback(err, accessories);
      }
    }.bind(this));
  }

  refreshDeviceData(callback) {
    this.log.debug(&#x22;Refreshing data for netatmo &#x22; + this.deviceType);
    this.cache.get(this.deviceType, function (err, data) {
      if (!err) {
        if (data == undefined) {
          this.log.debug(&#x22;Loading new data from netatmo for &#x22; + this.deviceType);
          this.loadDeviceData(function(err, data) {
            callback(err,data);
          }.bind(this));
        } else {
          this.deviceData = data;
          callback(null, data);
        }
      } else {
        callback(err, this.deviceData);
      }
    }.bind(this));
  }

  forceRefresh() {
    this.cache.del(this.deviceType, function(err,count) {
      this.refreshRequired = true;
    }.bind(this));
  }

  loadDeviceData(callback) {
    this.deviceData = null;
    callback(&#x22;The abstract method loadDeviceData should be overridden&#x22;, null)
  }

  buildAccessories(callback) {
    Object.keys(this.deviceData).forEach(function(key) {

      // key is id! Should go into blacklist / whitelist !

      var keep = true;

      if (this.config.whitelist &#x26;&#x26; this.config.whitelist.length &#x3e; 0) {
        keep = (this.config.whitelist.indexOf(key) &#x3e; -1);
      }
      if (this.config.blacklist &#x26;&#x26; this.config.blacklist.length &#x3e; 0) {
        keep = keep &#x26;&#x26; (this.config.blacklist.indexOf(key) &#x3c; 0);
      }

      if ( keep ) {
        var accessory = this.buildAccessory(this.deviceData[key]);
        this.log.debug(&#x22;Did build accessory &#x22; + accessory.name );
        this.accessories.push(accessory);
      }


    }.bind(this));
    callback(null, this.accessories);
  }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.thermostat_accessory" id="apidoc.module.homebridge-netatmo.thermostat_accessory">module homebridge-netatmo.thermostat_accessory</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_accessory.thermostat_accessory" id="apidoc.element.homebridge-netatmo.thermostat_accessory.thermostat_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class ThermostatAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData._id,
        &#x22;netatmoType&#x22;: deviceData.type,
        &#x22;firmware&#x22;: deviceData.firmware,
        &#x22;name&#x22;: deviceData.station_name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES
//        &#x22;dataTypes&#x22;
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.module_id = deviceData.modules[0]._id;
      this.currentTemperature = 11.1;
      this.targetTemperature = 20.0;
      this.batteryPercent = 100;
      this.lowBattery = false;

      this.currentHeatingCoolingState = Characteristic.CurrentHeatingCoolingState.OFF;
      this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.OFF;

      this.refreshData(function(err, data) {});

    }

    refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var thermostatData = this.mapAccessoryDataToThermostatData(accessoryData);
      this.applyThermostatData(thermostatData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    mapAccessoryDataToThermostatData(accessoryData) {
      // this.log(JSON.stringify(accessoryData));
      var result = {};
      var module = accessoryData.modules[0];

      if (module) {
        result.currentTemperature = module.measured.temperature;

        result.targetTemperature = 0;
        if (module.measured.setpoint_temp) {
          result.targetTemperature = module.measured.setpoint_temp;
        }

        var setpoint = module.setpoint;
        if (setpoint) {
          if (setpoint.setpoint_temp != undefined) {
            result.targetTemperature = setpoint.setpoint_temp;
            result.mode = setpoint.setpoint_mode;
          }
        }

        if (result.targetTemperature &#x3c; 10) result.targetTemperature = 10;

        result.heating = (module.therm_relay_cmd != 0);
        result.batteryPercent = module.battery_percent;

        result.lowBattery = false;
        if (module.battery_vp) {
          if (!result.batteryPercent) {
            result.batteryPercent = Math.min(Math.round(Math.max(module.battery_vp - MIN_BATTERY_LEVEL, 0) / (FULL_BATTERY_LEVEL
 - MIN_BATTERY_LEVEL) * 100), 100);
          }
          if (module.battery_vp &#x3c; LOW_BATTERY_LEVEL) {
            result.lowBattery = true;
          }
        }
        if (!result.batteryPercent) {
          result.batteryPercent = 100;
        }
      } else {
        this.device.forceRefresh();
      }
      return result;
    }

    applyThermostatData(thermostatData) {
      var dataChanged = false

      if(thermostatData.currentTemperature &#x26;&#x26; this.currentTemperature != thermostatData.currentTemperature) {
        this.currentTemperature = thermostatData.currentTemperature;
        dataChanged = true;
      }

      if(thermostatData.targetTemperature &#x26;&#x26; this.targetTemperature != thermostatData.targetTemperature) {
        this.targetTemperature = thermostatData.targetTemperature;
        dataChanged = true;
      }

      if(thermostatData.mode &#x26;&#x26; this.mode != thermostatData.mode) {
        this.mode = thermostatData.mode;
        switch(this.mode) {
          case &#x27;hg&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.COOL;
            break;
          case &#x27;max&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCoolingState.HEAT;
            break;
          case &#x27;off&#x27;:
            this.targetHeatingCoolingState = Characteristic.TargetHeatingCooli ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.thermostat_battery_homekit" id="apidoc.module.homebridge-netatmo.thermostat_battery_homekit">module homebridge-netatmo.thermostat_battery_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_battery_homekit.thermostat_battery_homekit" id="apidoc.element.homebridge-netatmo.thermostat_battery_homekit.thermostat_battery_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_battery_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_battery_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class BatteryService extends homebridge.hap.Service.BatteryService {
    constructor(accessory) {
      super(accessory.name + &#x22; Thermostat&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.BatteryLevel)
        .on(&#x27;get&#x27;, this.getBatteryLevel.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.StatusLowBattery)
        .on(&#x27;get&#x27;, this.getStatusLowBattery.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.ChargingState)
        .on(&#x27;get&#x27;, this.getChargingState.bind(this));
    }

    getBatteryLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.batteryPercent);
      }.bind(this));
    }

    getStatusLowBattery(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
      }.bind(this));
    }

    getChargingState(callback) {
      callback(null, Characteristic.ChargingState.NOT_CHARGING);
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.BatteryLevel)
            .updateValue(this.accessory.batteryPercent);
      this.getCharacteristic(Characteristic.StatusLowBattery)
            .updateValue(this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
    }
  }

  return BatteryService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.thermostat_device" id="apidoc.module.homebridge-netatmo.thermostat_device">module homebridge-netatmo.thermostat_device</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_device.thermostat_device" id="apidoc.element.homebridge-netatmo.thermostat_device.thermostat_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    ThermostatAccessory = require(&#x22;../accessory/thermostat-accessory&#x22;)(homebridge);
  }

  class ThermostatDeviceType extends NetatmoDevice {
    constructor(log, api, config) {
      super(log, api, config);
      this.deviceType = &#x22;thermostat&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getThermostatsData(function (err, devices) {
        if(!err) {
          var deviceMap = {};
          devices.forEach(function( device ) {
            deviceMap[device[&#x22;_id&#x22;]] = device;
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new ThermostatAccessory(deviceData, this);
    }

  }

  return ThermostatDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.thermostat_thermostat_homekit" id="apidoc.module.homebridge-netatmo.thermostat_thermostat_homekit">module homebridge-netatmo.thermostat_thermostat_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit.thermostat_thermostat_homekit" id="apidoc.element.homebridge-netatmo.thermostat_thermostat_homekit.thermostat_thermostat_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>thermostat_thermostat_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thermostat_thermostat_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class ThermostatService extends homebridge.hap.Service.Thermostat {
    constructor(accessory) {
      super(accessory.name + &#x22; Thermostat&#x22;);
      this.accessory = accessory;

      this.temperatureDisplayUnits = Characteristic.TemperatureDisplayUnits.CELSIUS;

      this.getCharacteristic(Characteristic.CurrentHeatingCoolingState)
        .on(&#x27;get&#x27;, this.getCurrentHeatingCoolingState.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TargetHeatingCoolingState)
        .on(&#x27;get&#x27;, this.getTargetHeatingCoolingState.bind(this))
        .on(&#x27;set&#x27;, this.setTargetHeatingCoolingState.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.CurrentTemperature)
        .on(&#x27;get&#x27;, this.getCurrentTemperature.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TargetTemperature)
        .on(&#x27;get&#x27;, this.getTargetTemperature.bind(this))
        .on(&#x27;set&#x27;, this.setTargetTemperature.bind(this))
        .eventEnabled = true;

      this.getCharacteristic(Characteristic.TemperatureDisplayUnits)
        .on(&#x27;get&#x27;, this.getTemperatureDisplayUnits.bind(this))
        .on(&#x27;set&#x27;, this.setTemperatureDisplayUnits.bind(this));

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentHeatingCoolingState)
            .updateValue(this.accessory.currentHeatingCoolingState);
      this.getCharacteristic(Characteristic.TargetHeatingCoolingState)
            .updateValue(this.accessory.targetHeatingCoolingState);
      this.getCharacteristic(Characteristic.CurrentTemperature)
            .updateValue(this.accessory.currentTemperature);
      // TODO: Unter 10 -&#x3e; Was tun?
      this.getCharacteristic(Characteristic.TargetTemperature)
            .updateValue(this.accessory.targetTemperature);
    }

    getCurrentHeatingCoolingState(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentHeatingCoolingState);
      }.bind(this));
    }

    getCurrentTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentTemperature);
      }.bind(this));
    }

    getTargetHeatingCoolingState(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.targetHeatingCoolingState);
      }.bind(this));
    }

    setTargetHeatingCoolingState(value, callback) {

        if (this.accessory.targetHeatingCoolingState === value) {
            callback(null, value);
            return;
        }

        switch (value) {
          case Characteristic.TargetHeatingCoolingState.OFF:
            this.accessory.setThermpoint(&#x27;off&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          case Characteristic.TargetHeatingCoolingState.COOL:
            this.accessory.setThermpoint(&#x27;hg&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          case Characteristic.TargetHeatingCoolingState.HEAT:
            this.accessory.setThermpoint(&#x27;max&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
            break;
          default: // Characteristic.TargetHeatingCoolingState.AUTO:
            this.accessory.setThermpoint(&#x27;program&#x27;, this.accessory.targetTemperature, function(err, data) {
              callback(err, value);
            }.bind(this));
        }
    }

    getTargetTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.targetTemperature);
      }.bind(this));
    }

    setTargetTemperature(value, callback) {
      if (value &#x3e; 30) {
        value = 30;
      }

      if (value == this.accessory.targetTemperature) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.toString" id="apidoc.module.homebridge-netatmo.toString">module homebridge-netatmo.toString</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.toString.toString" id="apidoc.element.homebridge-netatmo.toString.toString">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toString() { [native code] }</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_accessory" id="apidoc.module.homebridge-netatmo.weatherstation_accessory">module homebridge-netatmo.weatherstation_accessory</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_accessory.weatherstation_accessory" id="apidoc.element.homebridge-netatmo.weatherstation_accessory.weatherstation_accessory">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_accessory
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_accessory = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    NetatmoAccessory = require(&#x22;../lib/netatmo-accessory&#x22;)(homebridge);
    Characteristic = homebridge.hap.Characteristic;
  }

  class WeatherStationAccessory extends NetatmoAccessory {
    constructor(deviceData, netatmoDevice) {

      var dataTypes = deviceData.data_type;
      if (deviceData.battery_vp) {
        dataTypes.push(&#x22;Battery&#x22;);
      }

      var accessoryConfig = {
        &#x22;id&#x22;: deviceData._id,
        &#x22;netatmoType&#x22;: deviceData.type,
        &#x22;firmware&#x22;: deviceData.firmware,
        &#x22;name&#x22;: deviceData._name || &#x22;Netatmo &#x22; + netatmoDevice.deviceType + &#x22; &#x22; + deviceData._id,
        &#x22;defaultServices&#x22;: DEFAULT_SERVICES,
        &#x22;dataTypes&#x22;: dataTypes
      }

      super(homebridge, accessoryConfig, netatmoDevice);

      this.currentTemperature = 11.1;
      this.co2 = 500;
      this.batteryPercent = 100;
      this.lowBattery = false;
      this.airPressure = 1000;
      this.humidity = 50;
			this.noiseLevel = 0;
      this.rainLevel = 0.0;
      this.rainLevelSum1 = 0.0;
      this.rainLevelSum24 = 0.0;
      this.windStrength = 0;
      this.windAngle = 0;
      this.gustStrength = 0;
      this.gustAngle = 0;

      this.refreshData(function(err, data) {});
  	}

  	refreshData(callback) {
      this.device.refreshDeviceData(function (err, deviceData) {
        if (!err) {
          this.notifyUpdate(deviceData);
        }
        callback(err, deviceData);
      }.bind(this));
    }

    notifyUpdate(deviceData) {
      var accessoryData = this.extractAccessoryData(deviceData);
      var weatherData = this.mapAccessoryDataToWeatherData(accessoryData);
      this.applyWeatherData(weatherData);
    }

    extractAccessoryData(deviceData) {
      return deviceData[this.id];
    }

    getLowBatteryLevel() {
      var levels = {
        NAMain: 4560,
        NAModule1: 4000,
        NAModule2: 4360,
        NAModule3: 4000,
        NAModule4: 4560
      }

      if (levels[this.netatmoType]) {
        return levels[this.netatmoType];
      }
      return 4560;
    }

    getFullBatteryLevel() {
      var levels = {
        NAMain: 5640,
        NAModule1: 5500,
        NAModule2: 5590,
        NAModule3: 5500,
        NAModule4: 5640
      }

      if (levels[this.netatmoType]) {
        return levels[this.netatmoType];
      }
      return 5640;
    }


		mapAccessoryDataToWeatherData(accessoryData) {
		  var result = {};

		  var dashboardData = accessoryData.dashboard_data;
		  if (dashboardData) {
		  	if (dashboardData.Temperature) {
          result.currentTemperature = dashboardData.Temperature;
        }
        if (dashboardData.CO2) {
          result.co2 = dashboardData.CO2;
        }
        if (dashboardData.Pressure) {
          result.airPressure = dashboardData.Pressure;
        }
        if (dashboardData.Humidity) {
          result.humidity = dashboardData.Humidity;
        }
        if (dashboardData.Noise) {
          result.noiseLevel = dashboardData.Noise;
        }
        if (dashboardData.Rain) {
          result.rainLevel = Math.round(dashboardData.Rain * 1000) / 1000;
        }
        if (dashboardData.sum_rain_1) {
          result.rainLevelSum1 = Math.round(dashboardData.sum_rain_1 * 1000) / 1000;
        }
        if (dashboardData.sum_rain_24) {
          result.rainLevelSum24 = Math.round(dashboardData.sum_rain_24 * 1000) / 1000;
        }
        if (dashboardData.WindStrength) {
          result.windStrength = Math.round(dashboardData.WindStrength);
        }
        if (dashboardData.WindAngle) {
          result.windAngle = Math.round(dashboardData.WindAngle);
        }
        if (dashboardData.GustStrength) {
          result.gustStrength = Math.round(dashboardData.GustStrength);
        }
        if (dashboardData.GustAngle) {
          result.gustAngle = Math.round(dashboardData.GustAngle);
        }
		  }

      result.batteryPercent = accessoryData.battery_percent;
      result.lowBattery = false;

      if (accessoryData.battery_vp) {
        if (!result.batteryPercent ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_airpressure_legacy" id="apidoc.module.homebridge-netatmo.weatherstation_airpressure_legacy">module homebridge-netatmo.weatherstation_airpressure_legacy</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy.weatherstation_airpressure_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_airpressure_legacy.weatherstation_airpressure_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airpressure_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_airpressure_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class AtmosphericPressureCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Atmospheric Pressure&#x27;, ATMOSPHERIC_PRESSURE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;hPA&#x22;,
        minValue: 500,
        maxValue: 2000,
        minStep: 0.1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class AirPressureService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Air Pressure&#x22;, ATMOSPHERIC_PRESSURE_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(AtmosphericPressureCharacteristic)
        .on(&#x27;get&#x27;, this.getAtmosphericPressure.bind(this))
        .eventEnabled = true;

      // this.addOptionalCharacteristic(Characteristic.StatusActive);
      // this.addOptionalCharacteristic(Characteristic.StatusFault);
      this.addOptionalCharacteristic(Characteristic.Name);

    }

    updateCharacteristics() {
      this.getCharacteristic(AtmosphericPressureCharacteristic)
            .updateValue(this.accessory.airPressure);
    }

    getAtmosphericPressure(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.airPressure);
      }.bind(this));
    }

  }

  return AirPressureService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_airquality_homekit" id="apidoc.module.homebridge-netatmo.weatherstation_airquality_homekit">module homebridge-netatmo.weatherstation_airquality_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit.weatherstation_airquality_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_airquality_homekit.weatherstation_airquality_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_airquality_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_airquality_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class AirQualityService extends homebridge.hap.Service.AirQualitySensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Air Quality&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.AirQuality)
        .on(&#x27;get&#x27;, this.getAirQuality.bind(this))
        .eventEnabled = true;

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.AirQuality)
            .updateValue(this.transformCO2ToAirQuality());
    }

    getAirQuality(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.transformCO2ToAirQuality());
      }.bind(this));
    }

    transformCO2ToAirQuality() {
      var level = this.accessory.co2;
      var quality = Characteristic.AirQuality.UNKNOWN;

      if (level &#x3e; 2000) quality = Characteristic.AirQuality.POOR;
      else if (level &#x3e; 1500) quality = Characteristic.AirQuality.INFERIOR;
      else if (level &#x3e; 1000) quality = Characteristic.AirQuality.FAIR;
      else if (level &#x3e; 500) quality = Characteristic.AirQuality.GOOD;
      else if (level &#x3e; 0) quality = Characteristic.AirQuality.EXCELLENT;

      return quality;
    }

  }

  return AirQualityService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_battery_homekit" id="apidoc.module.homebridge-netatmo.weatherstation_battery_homekit">module homebridge-netatmo.weatherstation_battery_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_battery_homekit.weatherstation_battery_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_battery_homekit.weatherstation_battery_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_battery_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_battery_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class BatteryService extends homebridge.hap.Service.BatteryService {
    constructor(accessory) {
      super(accessory.name + &#x22; Battery Level&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.BatteryLevel)
        .on(&#x27;get&#x27;, this.getBatteryLevel.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.StatusLowBattery)
        .on(&#x27;get&#x27;, this.getStatusLowBattery.bind(this))
        .eventEnabled = true;
      this.getCharacteristic(Characteristic.ChargingState)
        .on(&#x27;get&#x27;, this.getChargingState.bind(this));
    }

    getBatteryLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.batteryPercent);
      }.bind(this));
    }

    getStatusLowBattery(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
      }.bind(this));
    }

    getChargingState(callback) {
      callback(null, Characteristic.ChargingState.NOT_CHARGING);
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.BatteryLevel)
            .updateValue(this.accessory.batteryPercent);
      this.getCharacteristic(Characteristic.StatusLowBattery)
            .updateValue(this.accessory.lowBattery ? Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW : Characteristic.StatusLowBattery
.BATTERY_LEVEL_NORMAL);
    }
  }

  return BatteryService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_co2_homekit" id="apidoc.module.homebridge-netatmo.weatherstation_co2_homekit">module homebridge-netatmo.weatherstation_co2_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_co2_homekit.weatherstation_co2_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_co2_homekit.weatherstation_co2_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_co2_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_co2_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class CarbonDioxideService extends homebridge.hap.Service.CarbonDioxideSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Carbon Dioxide&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.CarbonDioxideDetected)
        .on(&#x27;get&#x27;, this.getCarbonDioxideDetected.bind(this))
        .eventEnabled = true;

      var co2LevelCharacteristic = this.getCharacteristic(Characteristic.CarbonDioxideLevel)
                                          || this.addCharacteristic(Characteristic.CarbonDioxideLevel);

      co2LevelCharacteristic.on(&#x27;get&#x27;, this.getCarbonDioxideLevel.bind(this))
                            .eventEnabled = true;
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CarbonDioxideDetected)
            .updateValue(this.transformCO2ToCarbonDioxideDetected());
      this.getCharacteristic(Characteristic.CarbonDioxideLevel)
            .updateValue(this.accessory.co2);
    }

    getCarbonDioxideDetected(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.transformCO2ToCarbonDioxideDetected());
      }.bind(this));
    }

    getCarbonDioxideLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.co2);
      }.bind(this));
    }

    transformCO2ToCarbonDioxideDetected() {
      return (this.accessory.co2 &#x3e; 1000 ? Characteristic.CarbonDioxideDetected.CO2_LEVELS_ABNORMAL : Characteristic.CarbonDioxideDetected
.CO2_LEVELS_NORMAL);
    }
  }

  return CarbonDioxideService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_device" id="apidoc.module.homebridge-netatmo.weatherstation_device">module homebridge-netatmo.weatherstation_device</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_device.weatherstation_device" id="apidoc.element.homebridge-netatmo.weatherstation_device.weatherstation_device">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_device
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_device = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    WeatherStationAccessory = require(&#x22;../accessory/weatherstation-accessory&#x22;)(homebridge);
  }

  class WeatherstationDeviceType extends NetatmoDevice {
  	constructor(log, api, config) {
      super(log, api, config);
      this.log.debug(&#x22;Creating Weatherstation Devices&#x22;);
      this.deviceType = &#x22;weatherstation&#x22;;
    }

    loadDeviceData(callback) {
      this.api.getStationsData(function (err, devices) {
        if(!err) {
          var deviceMap = {};
          devices.forEach(function( device ) {
            deviceMap[device[&#x22;_id&#x22;]] = device;
            device._name = device.station_name + &#x22; &#x22; + device.module_name
            if (device.modules) {
              device.modules.forEach(function( module ) {
                module._name = device.station_name + &#x22; &#x22; + module.module_name
                deviceMap[module._id] = module;
              }.bind(this));
            }
          }.bind(this));
          this.cache.set(this.deviceType, deviceMap);
          this.deviceData = deviceMap;
        }
        callback(err, this.deviceData);
      }.bind(this));
    }

    buildAccessory(deviceData) {
      return new WeatherStationAccessory(deviceData, this);
    }
  }

  return WeatherstationDeviceType;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_humidity_homekit" id="apidoc.module.homebridge-netatmo.weatherstation_humidity_homekit">module homebridge-netatmo.weatherstation_humidity_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit.weatherstation_humidity_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_humidity_homekit.weatherstation_humidity_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_humidity_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_humidity_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class HumidityService extends homebridge.hap.Service.HumiditySensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Humidity&#x22;);
      this.accessory = accessory;

      this.getCharacteristic(Characteristic.CurrentRelativeHumidity)
        .on(&#x27;get&#x27;, this.getCurrentRelativeHumidity.bind(this))
        .eventEnabled = true;
    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentRelativeHumidity)
            .updateValue(this.accessory.humidity);
    }

    getCurrentRelativeHumidity(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.humidity);
      }.bind(this));
    }
  }

  return HumidityService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_noiselevel_legacy" id="apidoc.module.homebridge-netatmo.weatherstation_noiselevel_legacy">module homebridge-netatmo.weatherstation_noiselevel_legacy</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy.weatherstation_noiselevel_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_noiselevel_legacy.weatherstation_noiselevel_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_noiselevel_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_noiselevel_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class NoiseLevelCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Noise Level&#x27;, NOISE_LEVEL_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;dB&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class NoiseLevelService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Noise Level&#x22;, NOISE_LEVEL_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(NoiseLevelCharacteristic)
        .on(&#x27;get&#x27;, this.getNoiseLevel.bind(this))
        .eventEnabled = true;

      // this.addOptionalCharacteristic(Characteristic.StatusActive);
      // this.addOptionalCharacteristic(Characteristic.StatusFault);
      // this.addOptionalCharacteristic(Characteristic.StatusTampered);
      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(NoiseLevelCharacteristic)
            .updateValue(this.accessory.noiseLevel);
    }

    getNoiseLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.noiseLevel);
      }.bind(this));
    }

  }

  return NoiseLevelService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_rain_legacy" id="apidoc.module.homebridge-netatmo.weatherstation_rain_legacy">module homebridge-netatmo.weatherstation_rain_legacy</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_rain_legacy.weatherstation_rain_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_rain_legacy.weatherstation_rain_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_rain_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_rain_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class RainLevelCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level&#x27;, RAIN_LEVEL_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelSum1Characteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level (1 hour)&#x27;, RAIN_LEVEL_SUM_1H_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelSum24Characteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Rain Level (24 hours)&#x27;, RAIN_LEVEL_SUM_24H_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.FLOAT,
        unit: &#x22;mm&#x22;,
        minValue: 0,
        maxValue: 1000,
        minStep: 0.001,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class RainLevelService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Rain Level&#x22;, RAIN_LEVEL_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(RainLevelCharacteristic)
        .on(&#x27;get&#x27;, this.getRainLevel.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(RainLevelSum1Characteristic)
        .on(&#x27;get&#x27;, this.getRainLevelSum1.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(RainLevelSum24Characteristic)
        .on(&#x27;get&#x27;, this.getRainLevelSum24.bind(this))
        .eventEnabled = true;

      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(RainLevelCharacteristic)
            .updateValue(this.accessory.rainLevel);
      this.getCharacteristic(RainLevelSum1Characteristic)
            .updateValue(this.accessory.rainLevelSum1);
      this.getCharacteristic(RainLevelSum24Characteristic)
            .updateValue(this.accessory.rainLevelSum24);
    }

    getRainLevel(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevel);
      }.bind(this));
    }

    getRainLevelSum1(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevelSum1);
      }.bind(this));
    }

    getRainLevelSum24(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.rainLevelSum24);
      }.bind(this));
    }
  }

  return RainLevelService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_temperature_homekit" id="apidoc.module.homebridge-netatmo.weatherstation_temperature_homekit">module homebridge-netatmo.weatherstation_temperature_homekit</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit.weatherstation_temperature_homekit" id="apidoc.element.homebridge-netatmo.weatherstation_temperature_homekit.weatherstation_temperature_homekit">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_temperature_homekit
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_temperature_homekit = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class TemperatureService extends homebridge.hap.Service.TemperatureSensor {
    constructor(accessory) {
      super(accessory.name + &#x22; Temperature&#x22;);
      this.accessory = accessory;

      var tmpChar = this.getCharacteristic(Characteristic.CurrentTemperature);
      tmpChar.setProps({ minValue: -100 });
      tmpChar.on(&#x27;get&#x27;, this.getCurrentTemperature.bind(this));
      tmpChar.eventEnabled = true;

    }

    updateCharacteristics() {
      this.getCharacteristic(Characteristic.CurrentTemperature)
            .updateValue(this.accessory.currentTemperature);
    }

    getCurrentTemperature(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.currentTemperature);
      }.bind(this));
    }
  }

  return TemperatureService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-netatmo.weatherstation_wind_legacy" id="apidoc.module.homebridge-netatmo.weatherstation_wind_legacy">module homebridge-netatmo.weatherstation_wind_legacy</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-netatmo.weatherstation_wind_legacy.weatherstation_wind_legacy" id="apidoc.element.homebridge-netatmo.weatherstation_wind_legacy.weatherstation_wind_legacy">
        function <span class="apidocSignatureSpan">homebridge-netatmo.</span>weatherstation_wind_legacy
        <span class="apidocSignatureSpan">(pHomebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">weatherstation_wind_legacy = function (pHomebridge) {
  if (pHomebridge &#x26;&#x26; !homebridge) {
    homebridge = pHomebridge;
    Characteristic = homebridge.hap.Characteristic;
  }

  class WindStrengthCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Wind Strength&#x27;, WIND_STRENGTH_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
              format: Characteristic.Formats.UINT8,
        unit: &#x22;km/h&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class WindAngleCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Wind Angle&#x27;, WIND_ANGLE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;deg&#x22;,
        minValue: 0,
        maxValue: 360,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class GustStrengthCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Gust Strength&#x27;, GUST_STRENGTH_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
              format: Characteristic.Formats.UINT8,
        unit: &#x22;km/h&#x22;,
        minValue: 0,
        maxValue: 200,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class GustAngleCharacteristic extends Characteristic {
    constructor(accessory) {
      super(&#x27;Gust Angle&#x27;, GUST_ANGLE_CTYPE_ID);
      this.setProps({
        format: Characteristic.Formats.UINT8,
        unit: &#x22;deg&#x22;,
        minValue: 0,
        maxValue: 360,
        minStep: 1,
        perms: [
          Characteristic.Perms.READ,
          Characteristic.Perms.NOTIFY
        ]
      });
      this.value = this.getDefaultValue();
    }
  }

  class WindService extends homebridge.hap.Service {
    constructor(accessory) {
      super(accessory.name + &#x22; Wind Sensor&#x22;, WIND_MEASURE_STYPE_ID);
      this.accessory = accessory;

      this.addCharacteristic(WindStrengthCharacteristic)
        .on(&#x27;get&#x27;, this.getWindStrength.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(WindAngleCharacteristic)
        .on(&#x27;get&#x27;, this.getWindAngle.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(GustStrengthCharacteristic)
        .on(&#x27;get&#x27;, this.getGustStrength.bind(this))
        .eventEnabled = true;
      this.addCharacteristic(GustAngleCharacteristic)
        .on(&#x27;get&#x27;, this.getGustAngle.bind(this))
        .eventEnabled = true;

      this.addOptionalCharacteristic(Characteristic.Name);
    }

    updateCharacteristics() {
      this.getCharacteristic(WindStrengthCharacteristic)
            .updateValue(this.accessory.windStrength);
      this.getCharacteristic(WindAngleCharacteristic)
            .updateValue(this.accessory.windAngle);
      this.getCharacteristic(GustStrengthCharacteristic)
            .updateValue(this.accessory.gustStrength);
      this.getCharacteristic(GustAngleCharacteristic)
            .updateValue(this.accessory.gustAngle);
    }

    getWindStrength(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.windStrength);
      }.bind(this));
    }

    getWindAngle(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.windAngle);
      }.bind(this));
    }

    getGustStrength(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.gustStrength);
      }.bind(this));
    }

    getGustAngle(callback) {
      this.accessory.refreshData(function(err,data) {
        callback(err, this.accessory.gustAngle);
      }.bind(this));
    }
  }

  return WindService;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
